<!-- /index.html â€” Quiet-Cinema Single-File (bereinigt, keine Extras) -->
<!DOCTYPE html>
<html lang="de" class="no-js" translate="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="robots" content="index,follow,max-image-preview:large" />
  <meta name="theme-color" content="#05070E" />
  <title>2 Minuten â€“ zeigt sofort, was heute wichtig ist.</title>
  <meta name="description" content="Ruhiger 2-Minuten-Blick: zeigt, was heute ansteht â€“ anonym, ohne Unterlagen, ohne Verkauf." />
  <!-- Icons/Manifest -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <!-- Preconnect (falls Bilder/Assets extern) -->
  <link rel="preconnect" href="https://static.wixstatic.com" crossorigin />
  <link rel="dns-prefetch" href="https://static.wixstatic.com" />
  <!-- ===== styles.css (inline) ===== -->
  <style>
    /* ===================== TOKENS / BASE ===================== */
    :root{
      --bg:#05070E; --bg2:#0B0F19; --text:#F1F3FA; --muted:#A8B1C5; --muted-soft:#8F97AA;
      --gold:#C8A44B; --gold2:#EADCA8; --focus:#90C2FF;
      --line:rgba(255,255,255,.14); --glass:rgba(255,255,255,.06);
      --green:#2ecc71; --amber:#ffcc33; --red:#ff4d4d;
      --g1:.5rem; --g2:.75rem; --g3:1rem; --g4:1.5rem; --g5:2rem; --g6:3rem; --g7:4rem;
      --ease:cubic-bezier(.25,.46,.25,1); --motion:1;
      --shadow-deep:0 34px 110px rgba(0,0,0,.68); --shadow-soft:0 16px 52px rgba(0,0,0,.46);
      --container:1120px; --gutter:clamp(16px,5vw,32px);
      --heroHue:220; /* Time-of-day tint */
      font-size:clamp(16px,0.9vw + 8px,20px);
    }
    @media (prefers-reduced-motion:reduce){ :root{--motion:0} }
    *{box-sizing:border-box}
    html,body{height:auto}
    body{
      margin:0; color:var(--text);
      font:16px/1.55 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
      background:
        radial-gradient(1200px 600px at 10% -10%, rgba(200,164,75,.10), transparent 55%),
        radial-gradient(900px 600px at 92% -8%, rgba(130,150,255,.10), transparent 60%),
        linear-gradient(180deg,#04060E,#060915);
      -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    }
    h1,h2,h3{line-height:1.15;margin:0 0 var(--g3);letter-spacing:.1px}
    h1{font-size:clamp(34px,5.4vw,60px);font-weight:800}
    h2{font-size:clamp(22px,3.2vw,32px);font-weight:750}
    h3{font-size:clamp(18px,2.2vw,24px);font-weight:650}
    p{margin:0 0 var(--g3)}
    a{color:inherit;text-decoration:none}
    .micro{font-size:.92rem;color:var(--muted)}
    .muted{color:var(--muted)}
    .hidden{display:none}

    /* Layout helpers */
    .container{max-width:var(--container); margin-inline:auto; padding-inline:var(--gutter)}
    .stack>*+*{margin-top:var(--g3)}
    .grid{display:grid; gap:var(--g3)}
    .auto-grid{grid-template-columns:repeat(auto-fit,minmax(min(100%,320px),1fr))}
    .center{text-align:center}
    .mb-0{margin-bottom:0} .mb-6{margin-bottom:var(--g6)}

    /* A11y */
    .visually-hidden{position:absolute!important;width:1px;height:1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;clip-path:inset(50%);border:0;padding:0;margin:-1px}
    :focus-visible{outline:2px solid var(--focus); outline-offset:3px; border-radius:10px}

    /* Chips */
    .chip{display:inline-flex;align-items:center;gap:.5rem;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06);border-radius:999px;padding:.42rem .9rem;font-size:.92rem;color:var(--muted-soft)}
    .chips{display:flex;flex-wrap:wrap;gap:.6rem}

    /* Header / Chrome */
    header{position:sticky;top:0;z-index:80;background:rgba(5,8,22,.92);backdrop-filter:saturate(1.05) blur(6px);border-bottom:1px solid rgba(255,255,255,.08)}
    .header-bar{display:flex;align-items:center;justify-content:space-between;gap:var(--g2);padding-block:.8rem}
    .brand{display:flex;flex-direction:column;gap:.1rem;font-weight:800}
    .brand-top{display:flex;align-items:center;gap:.5rem}
    .brand-dot{width:.6rem;height:.6rem;border-radius:50%;background:linear-gradient(135deg,var(--gold),var(--gold2))}
    .bar{display:flex;gap:.6rem;flex-wrap:wrap;align-items:center}

    .btn{display:inline-flex;align-items:center;justify-content:center;min-height:48px;padding:.9rem 1.4rem;border-radius:999px;border:1px solid transparent;background:rgba(255,255,255,.06);color:var(--text);font-weight:850;cursor:pointer;transition:transform .18s var(--ease), box-shadow .18s var(--ease)}
    .btn:hover{transform:translateY(-1px)} .btn:active{transform:translateY(1px) scale(.99)}
    .btn[aria-disabled="true"]{opacity:.55;pointer-events:none}
    .btn.small{min-height:40px;padding:.55rem .9rem;font-weight:750;font-size:.95rem}
    .btn-primary{background:linear-gradient(135deg,var(--gold),var(--gold2));color:#111;box-shadow:0 12px 28px rgba(200,164,75,.35)}
    .btn-primary:hover{box-shadow:0 18px 40px rgba(200,164,75,.40)}
    .btn-ghost{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.16)}

    /* Cards */
    .card, .trust-card, .premium-card, .tool-card{
      background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.12); border-radius:18px; padding:var(--g4)
    }

    /* Motion helpers */
    .fade-up{opacity:0;transform:translateY(18px)}
    .fade-up.visible{opacity:1;transform:none;transition:opacity .5s var(--ease),transform .5s var(--ease)}

    /* Cinema pack */
    .cinema-bars{position:fixed;inset:0;pointer-events:none;z-index:120}
    .cinema-bars::before,.cinema-bars::after{content:"";position:absolute;left:0;right:0;height:10svh;background:linear-gradient(180deg,rgba(0,0,0,.65),rgba(0,0,0,0))}
    .cinema-bars::before{top:0}.cinema-bars::after{bottom:0;transform:scaleY(-1)}
    .film-grain{position:fixed;inset:0;z-index:110;pointer-events:none;opacity:.2;mix-blend-mode:overlay;transition:opacity .4s var(--ease)}
    .film-grain.off{opacity:0}
    .film-grain{background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="180" height="180"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.85" numOctaves="2"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity=".7"/></svg>')}
    .cut-overlay{position:fixed;inset:0;z-index:105;pointer-events:none;opacity:0;background:radial-gradient(120% 50% at 50% 45%, rgba(255,255,255,.06), transparent 60%);transition:opacity .25s var(--ease)}

    .title-card{position:fixed;inset:0;z-index:190;display:grid;place-items:center;pointer-events:none;opacity:0;transform:translateY(6px);transition:opacity .5s var(--ease),transform .5s var(--ease)}
    .title-card.on{opacity:1;transform:none}
    .tc-inner{text-align:center;filter:drop-shadow(0 10px 30px rgba(0,0,0,.45))}
    .tc-kicker{display:block;letter-spacing:.22em;text-transform:uppercase;color:#E8EAF6;font-size:.82rem;opacity:.85}
    .tc-title{font-size:clamp(32px,5vw,54px);font-weight:900;letter-spacing:.02em}

    /* Spotlight */
    .spotlight{position:fixed;inset:0;pointer-events:none;z-index:115;mix-blend-mode:screen;opacity:0;transition:opacity .35s var(--ease)}
    .spotlight.on{opacity:.35}
    .spotlight::before{content:"";position:absolute;left:var(--x,50%);top:var(--y,50%);width:42vmin;height:42vmin;transform:translate(-50%,-50%);border-radius:999px;background:radial-gradient(circle, rgba(233,211,168,.45), transparent 60%)}

    /* HERO */
    .hero{padding-top:clamp(28px,4vw,64px);padding-bottom:clamp(16px,2.5vw,28px);position:relative;overflow:hidden}
    .stage{position:absolute; inset:0; pointer-events:none; z-index:-1; overflow:hidden}
    #nebula{position:absolute; inset:0; z-index:0; filter:blur(.2px); opacity:.65}
    .kenburns{position:absolute; inset:-10%; background-image:url('https://static.wixstatic.com/media/4e46cf_b23cf1a26a0f40a9a7e4e12f2b0174a9~mv2.png'); background-size:cover; background-position:center; opacity:.12; transform:scale(1); animation:kb 26s ease-in-out infinite alternate}
    @media (prefers-reduced-motion: no-preference){ @keyframes kb{to{transform:scale(1.12) translateY(-1.5%)}} }

    /* CHECK */
    .progress-dial{--p:0; width:64px;height:64px;border-radius:999px;background:conic-gradient(from -90deg, var(--gold) calc(var(--p)*1%), rgba(255,255,255,.12) 0);display:grid;place-items:center;border:1px solid rgba(255,255,255,.12)}
    .progress-dial span{font-weight:800;font-size:.9rem;background:linear-gradient(135deg,var(--gold),var(--gold2));-webkit-background-clip:text;background-clip:text;color:transparent}
    .step{display:none}.step.active{display:block}
    .options{display:grid;gap:var(--g3);grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}
    .opt{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.16);padding:14px;border-radius:14px;cursor:pointer;transition:transform .18s var(--ease)}
    .opt:hover{transform:translateY(-2px)}
    .result-card{padding:var(--g4);border-radius:18px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.05)}

    /* SOCIAL PROOF */
    .ticker{position:relative;overflow:hidden;border-radius:14px;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.04)}
    .ticker .track{display:flex;gap:1.1rem;animation:scroll 28s linear infinite}
    .ticker .item{white-space:nowrap;padding:.7rem 1rem;border-radius:999px;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.05);display:inline-flex;align-items:center;gap:.5rem}
    @keyframes scroll{to{transform:translateX(-50%)}}

    /* Sticky CTA */
    .sticky-cta{position:fixed;left:0;right:0;bottom:0;z-index:70;transform:translateY(100%);opacity:0;transition:transform .25s var(--ease),opacity .25s var(--ease)}
    .sticky-cta .inner{max-width:640px;margin:0 auto;padding:.6rem var(--gutter)}

    /* Whisper */
    .whisper{position:fixed;left:18px;bottom:18px;z-index:70;background:rgba(11,15,22,.92);border:1px solid rgba(255,255,255,.14);color:#F6F7FB;border-radius:14px;padding:.6rem .8rem;box-shadow:0 12px 28px rgba(0,0,0,.38);opacity:0;transform:translateY(10px);transition:opacity .25s var(--ease), transform .25s var(--ease)}

    /* Print: nur Ergebnis */
    @media print{
      body{background:#fff;color:#000}
      header, .title-card, .cinema-bars, .film-grain, .cut-overlay, .sticky-cta, .whisper, #zielgruppen-szenen, #prozess, #sicherheit, #before-after, #ethos-social, #final-cta, #tools, #social, footer, #hero, .spotlight, #nebula{display:none !important}
      #ampel-check{display:block !important}
      .result-card{background:#fff !important;color:#000 !important;border:1px solid #000 !important}
    }
  </style>
</head>
<body>
  <!-- Title Card -->
  <div class="title-card" aria-hidden="true" id="titleCard">
    <div class="tc-inner">
      <span class="tc-kicker">Ein ruhiger Blick</span>
      <h2 class="tc-title">Was heute wichtig ist</h2>
    </div>
  </div>

  <!-- Cinematic Overlays -->
  <div class="cut-overlay" aria-hidden="true"></div>
  <div class="cinema-bars" aria-hidden="true"></div>
  <div class="film-grain off" aria-hidden="true"></div>
  <div class="spotlight" id="spotlight" aria-hidden="true"></div>

  <a href="#main" class="visually-hidden" id="skipLink">Zum Inhalt springen</a>

  <!-- Header -->
  <header role="banner">
    <div class="container header-bar">
      <a href="#hero" class="brand" aria-label="Startseite">
        <div class="brand-top"><span class="brand-dot" aria-hidden="true"></span>Heiko Haerter</div>
        <span class="micro" style="letter-spacing:.08em;text-transform:uppercase">PersÃ¶nliche Finanzbegleitung</span>
      </a>
      <div class="bar" role="group" aria-label="Ansicht">
        <button class="btn btn-ghost" id="soundBtn" aria-pressed="false" aria-controls="main" title="Soundeffekte an/aus">ğŸ”ˆ Sound</button>
        <button class="btn btn-ghost" id="cinemaToggle" aria-pressed="true" aria-controls="main" title="Kino-Modus an/aus">ğŸ¬ Kino</button>
        <button class="btn btn-ghost" id="dfBtn" aria-pressed="false" aria-controls="main" type="button" title="Nur das Wichtigste anzeigen">ğŸ” Kurzmodus</button>
      </div>
    </div>
  </header>

  <main id="main" role="main" tabindex="-1">
    <!-- ===== ACT I: HERO ===== -->
    <section id="hero" class="hero section fade-up" aria-labelledby="hero-title">
      <div class="stage">
        <canvas id="nebula" aria-hidden="true"></canvas>
        <div class="kenburns" aria-hidden="true"></div>
      </div>
      <div class="container">
        <div class="stack" style="max-width:980px">
          <h1 id="hero-title">2 Minuten. 3 kurze Fragen.<br />Ergebnis: <em>Rot Â· Gelb Â· GrÃ¼n</em></h1>
          <p class="micro" id="heroLine">Ruhig. Anonym. Ohne Verkauf.</p>
          <div class="bar">
            <a class="btn btn-primary" id="startCheckHero" aria-describedby="checkHint">âš¡ Jetzt starten</a>
            <span class="chip" aria-hidden="true">Tasten: 1 Â· 2 Â· 3</span>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== SOCIAL PROOF / TRUST ===== -->
    <section id="social" class="section fade-up" aria-labelledby="social-h">
      <div class="container stack">
        <h2 id="social-h">Vertrauen entsteht durch Klarheit</h2>
        <div class="grid auto-grid">
          <div class="trust-card" data-tilt>
            <div class="chips">
              <span class="chip">ğŸ”’ Keine Datenweitergabe</span>
              <span class="chip">ğŸ•Šï¸ Ohne Verpflichtung</span>
              <span class="chip">ğŸ§­ Ergebnis zuerst</span>
            </div>
          </div>
          <div class="trust-card">
            <h3 style="margin-bottom:.3rem">Stimmen</h3>
            <div class="ticker" aria-label="Nutzerstimmen">
              <div class="track" aria-hidden="true">
                <span class="item">â€HÃ¤tte ich frÃ¼her gebraucht.â€œ â€” M.</span>
                <span class="item">â€2 Minuten, und wir wussten: alles gut.â€œ â€” M &amp; T</span>
                <span class="item">â€Endlich kein Verkauf. Danke.â€œ â€” M.M.</span>
                <span class="item">â€Genau die Reihenfolge, die gefehlt hat.â€œ â€” M.</span>
                <span class="item">â€Leicht. Ruhig. Hilft.â€œ â€” M.</span>
                <!-- Loop again for seamless scroll -->
                <span class="item">â€HÃ¤tte ich frÃ¼her gebraucht.â€œ â€” M.</span>
                <span class="item">â€2 Minuten, und wir wussten: alles gut.â€œ â€” M &amp; T</span>
                <span class="item">â€Endlich kein Verkauf. Danke.â€œ â€” M.M.</span>
                <span class="item">â€Genau die Reihenfolge, die gefehlt hat.â€œ â€” M.</span>
                <span class="item">â€Leicht. Ruhig. Hilft.â€œ â€” M.</span>
              </div>
            </div>
          </div>
          <div class="trust-card" data-tilt>
            <h3 style="margin-bottom:.3rem">Sicherheitsversprechen</h3>
            <ul class="micro" style="margin:0;padding-left:1.1rem">
              <li>Transparenz: Du siehst sofort deine Ampel.</li>
              <li>Null Druck: Kein Nachfassen, kein Verkauf.</li>
              <li>Kontrolle: Mini-Plan <em>Jetzt Â· Als NÃ¤chstes Â· SpÃ¤ter</em>.</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== CHECK (App) ===== -->
    <section id="ampel-check" class="section fade-up" aria-labelledby="check-h">
      <div class="container" style="max-width:720px">
        <div class="stack" id="check-start">
          <div class="bar" style="align-items:center;justify-content:space-between">
            <h2 id="check-h" class="mb-0">Dein 2-Minuten-Check</h2>
            <div class="progress-dial" role="img" aria-label="Fortschritt"><span id="dialPct">0%</span></div>
          </div>
          <p class="micro" id="checkHint">3 kurze Fragen â†’ sofort deine Ampel.</p>
          <div class="bar">
            <a class="btn btn-primary" id="startCheckBtn" aria-describedby="checkHint">âš¡ Jetzt starten</a>
            <span class="chip" aria-hidden="true">Tasten: 1 Â· 2 Â· 3</span>
          </div>
          <small class="micro" style="opacity:.8">Tipp: 1, 2 oder 3 auf der Tastatur wÃ¤hlt eine Antwort.</small>
        </div>

        <div id="check-steps" style="display:none;margin-top:1.2rem" aria-live="polite" aria-busy="false">
          <div class="premium-card" style="margin-bottom:.8rem">
            <div class="bar" style="align-items:center;justify-content:space-between;gap:.6rem;margin-bottom:.6rem">
              <strong id="stepLabel">Schritt 1 von 3</strong>
              <span class="micro" id="stepHint">Intuition reicht.</span>
            </div>

            <div class="step active" data-step="1">
              <h3>1 Â· Wie sicher wirkt euer Einkommen bei 6 Monaten Ausfall?</h3>
              <div class="options">
                <button class="btn opt" data-value="3">Sehr sicher</button>
                <button class="btn opt" data-value="2">Teils/unsicher</button>
                <button class="btn opt" data-value="1">Keine Ahnung</button>
              </div>
            </div>

            <div class="step" data-step="2">
              <h3>2 Â· Wer hÃ¤ngt finanziell an dir?</h3>
              <div class="options">
                <button class="btn opt" data-value="1">Nur ich</button>
                <button class="btn opt" data-value="2">Partner</button>
                <button class="btn opt" data-value="3">Partner + Kind(er)/Team</button>
              </div>
            </div>

            <div class="step" data-step="3">
              <h3>3 Â· Notgroschen/Puffer â€“ wie viele Monate?</h3>
              <div class="options">
                <button class="btn opt" data-value="3">6+ Monate</button>
                <button class="btn opt" data-value="2">2â€“5 Monate</button>
                <button class="btn opt" data-value="1">&lt; 2 Monate</button>
              </div>
            </div>

            <div class="bar" style="justify-content:flex-end;margin-top:.8rem">
              <button class="btn btn-ghost small" id="restartBtn" type="button">â†º Neu starten</button>
            </div>
          </div>
          <div class="micro" id="progressBarText" aria-hidden="true"></div>
        </div>

        <div id="check-result" class="stack" style="display:none"></div>
      </div>
    </section>

    <!-- ===== SHARE ===== -->
    <section class="section fade-up" id="share" aria-labelledby="share-title" style="display:none">
      <div class="container">
        <h2 id="share-title">Einfach weitergeben â€“ ohne etwas erklÃ¤ren zu mÃ¼ssen</h2>
        <div class="stack" style="max-width:720px">
          <label class="micro" for="refName">Dein Vorname (optional):</label>
          <input id="refName" name="refName" placeholder="z. B. Alex (Papa) / Dani â€“ Chef" autocomplete="name" />
          <h3 style="margin:.2rem 0 .25rem">Text zum Weitergeben</h3>
          <p class="micro">Kopieren oder direkt per WhatsApp senden.</p>

          <textarea rows="6" id="refText" spellcheck="false"></textarea>
          <div class="bar">
            <button class="btn small" id="readyMsg" type="button">âœ¨ Fertiger Text</button>
            <button class="btn small" id="magicLine" type="button">â• Opener</button>
            <button class="btn small" id="addPersonal" type="button">âœï¸ PersÃ¶nlich</button>
            <button class="btn small" id="copyShare" type="button">ğŸ“‹ Kopieren</button>
            <button class="btn small" id="nativeShare" type="button">ğŸ”— Teilenâ€¦</button>
            <a id="waShare" class="btn btn-primary small" target="_blank" rel="noopener">WhatsApp</a>
            <a id="mailShare" class="btn small" target="_blank" rel="noopener">Mail</a>
          </div>
          <div class="micro" id="sharePreview" aria-live="polite"></div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="section">
    <div class="container center micro muted">Zero-Sales. 100 % Kontrolle. <span class="js-year-now"></span></div>
  </footer>

  <!-- Sticky CTA -->
  <div class="sticky-cta" id="stickyCTA" aria-hidden="true">
    <div class="inner"><a href="#ampel-check" class="btn btn-primary" id="ctaFinal">âš¡ 2-Minuten-Check</a></div>
  </div>

  <!-- Whisper -->
  <div class="whisper" id="whisper" role="status" aria-live="polite">ğŸŸ¡ 10 Sekunden â€“ jemand weiÃŸ morgen, was ansteht.</div>

  <!-- ===== app.js (inline) ===== -->
  <script>
  (function(){
    "use strict";
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    document.documentElement.classList.remove('no-js');
    $$('.js-year-now').forEach(el=> el.textContent=new Date().getFullYear());

    /* Time-of-day tint */
    (function(){
      const h=(new Date()).getHours();
      const hue = (h<6)?220:(h<12)?205:(h<18)?200:230;
      document.documentElement.style.setProperty('--heroHue', hue);
    })();

    /* Canvas nebula (guarded) */
    (function(){
      const prefersReduced = matchMedia("(prefers-reduced-motion: reduce)").matches;
      const c=$('#nebula'); if(!c||prefersReduced) return;
      const ctx=c.getContext('2d',{alpha:true});
      function size(){ c.width=innerWidth; c.height=$('#hero')?.offsetHeight||innerHeight*0.6; }
      size(); addEventListener('resize', size, {passive:true});
      const N=Math.min(120, Math.floor(innerWidth/12));
      const p=Array.from({length:N},()=>({x:Math.random()*c.width,y:Math.random()*c.height,vx:(Math.random()-.5)*.15,vy:(Math.random()-.5)*.15,r:Math.random()*1.5+0.4,o:Math.random()*0.5+0.3}));
      let raf;
      const loop=()=>{ raf=requestAnimationFrame(loop);
        ctx.clearRect(0,0,c.width,c.height);
        for(const s of p){
          s.x+=s.vx; s.y+=s.vy;
          if(s.x<0||s.x>c.width) s.vx*=-1; if(s.y<0||s.y>c.height) s.vy*=-1;
          ctx.beginPath(); ctx.fillStyle=`rgba(255,255,255,${0.25*s.o})`; ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fill();
        }
      }; loop();
      addEventListener('visibilitychange',()=>{ if(document.hidden){ cancelAnimationFrame(raf);} else loop(); },{passive:true});
    })();

    /* Title Card + whoosh (optional) */
    let audioEnabled=false, audioCtx;
    function whoosh(){
      if(!audioEnabled) return;
      try{
        audioCtx = audioCtx || new (window.AudioContext||window.webkitAudioContext)();
        const o = audioCtx.createOscillator(), g = audioCtx.createGain();
        o.type='sine'; o.frequency.setValueAtTime(220,audioCtx.currentTime);
        o.frequency.exponentialRampToValueAtTime(40,audioCtx.currentTime+0.34);
        g.gain.setValueAtTime(0.0001,audioCtx.currentTime);
        g.gain.exponentialRampToValueAtTime(0.2,audioCtx.currentTime+0.06);
        g.gain.exponentialRampToValueAtTime(0.0001,audioCtx.currentTime+0.4);
        o.connect(g).connect(audioCtx.destination); o.start(); o.stop(audioCtx.currentTime+0.42);
      }catch(_){}
    }
    (function(){
      const tc=$('#titleCard'); if(!tc) return;
      setTimeout(()=> tc.classList.add('on'), 220);
      if(matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      setTimeout(()=> tc.classList.remove('on'), 2600);
      whoosh();
    })();

    /* Header/Cinema grain show after hero */
    (function(){
      const hero=$('#hero'); const grain=$('.film-grain'); const bars=$('.cinema-bars');
      if(!hero) return;
      if(!('IntersectionObserver' in window)){ grain?.classList.remove('off'); return; }
      new IntersectionObserver((ents)=>{
        const inView = ents[0].isIntersecting;
        grain?.classList.toggle('off', inView);
        // Sticky CTA
        const sticky=$('#stickyCTA');
        if(sticky){
          const show = !inView && innerWidth<980;
          sticky.style.transform=show?'translateY(0)':'translateY(100%)';
          sticky.style.opacity=show?'1':'0';
          sticky.setAttribute('aria-hidden', show?'false':'true');
        }
      },{threshold:.2}).observe(hero);
    })();

    /* Spotlight cursor (desktop only) */
    (function(){
      const pref=matchMedia('(prefers-reduced-motion: reduce)').matches;
      const canHover=matchMedia('(hover:hover)').matches;
      const spot=$('#spotlight'); if(!spot||pref||!canHover) return;
      spot.classList.add('on');
      let raf;
      addEventListener('pointermove',(e)=>{
        cancelAnimationFrame(raf);
        raf=requestAnimationFrame(()=>{
          spot.style.setProperty('--x', e.clientX+'px');
          spot.style.setProperty('--y', e.clientY+'px');
        });
      },{passive:true});
      addEventListener('pointerenter', ()=> spot.classList.add('on'), {passive:true});
      addEventListener('pointerleave', ()=> spot.classList.remove('on'), {passive:true});
    })();

    /* Kurzmodus (nur Kern) */
    (function(){
      const btn=$('#dfBtn'); if(!btn) return;
      const keep=new Set(['hero','ampel-check','share','social']);
      const nodes=[...$$('main > section')].filter(s=>!keep.has(s.id));
      let active=false;
      const set=(on)=>{
        active=on; btn.setAttribute('aria-pressed', on?'true':'false');
        btn.textContent=on?'âœ… Kurzmodus aktiv':'ğŸ” Kurzmodus';
        nodes.forEach(n=> n.style.display = on ? 'none' : '');
        if(on) window.scrollTo({top:0,behavior:'smooth'});
      };
      btn.addEventListener('click', ()=> set(!active), {passive:true});
    })();

    /* Cinema toggle */
    (function(){
      const btn=$('#cinemaToggle'); const bars=$('.cinema-bars'); const grain=$('.film-grain');
      if(!btn||!bars||!grain) return;
      let on=true;
      const set=(v)=>{ on=v; btn.setAttribute('aria-pressed', on?'true':'false'); bars.style.display = on ? '' : 'none'; grain.classList.toggle('off', !on); };
      btn.addEventListener('click', ()=> set(!on), {passive:true});
      set(true);
    })();

    /* Whisper once per session */
    (function(){
      const KEY='hh_whisper_seen_v6';
      try{
        if(sessionStorage.getItem(KEY)) return;
        const w=$('#whisper'); if(!w) return;
        setTimeout(()=>{ w.style.opacity='1'; w.style.transform='translateY(0)';
          setTimeout(()=>{ w.style.opacity='0'; w.style.transform='translateY(10px)'; }, 4200);
          sessionStorage.setItem(KEY,'1');
        }, 16000);
      }catch(_){}
    })();

    /* Smooth anchor + whoosh */
    (function(){
      const prefersReduced = matchMedia("(prefers-reduced-motion: reduce)").matches;
      const cut = $('.cut-overlay');
      function cinematicScroll(target){
        target.scrollIntoView({behavior: prefersReduced?'auto':'smooth', block:'start'});
        if(!prefersReduced && cut){ cut.style.opacity='1'; setTimeout(()=> cut.style.opacity='0', 320); }
      }
      $$('a[href^="#"]').forEach(a=>{
        a.addEventListener('click',(e)=>{
          const id=a.getAttribute('href'); if(id && id.length>1){
            const t=$(id); if(t){ e.preventDefault(); cinematicScroll(t); whoosh(); $('#main')?.focus(); }
          }
        }, {passive:false});
      });
      $('#skipLink')?.addEventListener('click',()=>$('#main')?.focus(),{passive:true});
    })();

    /* Tilt/Parallax (nicht im Hero) */
    (function initParallax(){
      const pref=matchMedia("(prefers-reduced-motion: reduce)").matches; if(pref) return;
      const cards = $$('[data-tilt]').filter(el => !el.closest('#hero')); if(!cards.length) return;
      let raf;
      const onScroll=()=>{
        cancelAnimationFrame(raf);
        raf=requestAnimationFrame(()=>{
          const ih=innerHeight||1;
          cards.forEach(c=>{
            const r=c.getBoundingClientRect(); const p=(r.top/ih - .5);
            c.style.transform=`translate3d(0,${p*-14}px,0)`;
          });
        });
      };
      addEventListener('scroll', onScroll, {passive:true}); onScroll();
      const canHover=matchMedia('(hover:hover)').matches; if(!canHover) return;
      const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));
      let raf2;
      addEventListener('pointermove',(e)=>{
        cancelAnimationFrame(raf2);
        raf2=requestAnimationFrame(()=>{
          cards.forEach(el=>{
            const r=el.getBoundingClientRect();
            const x=clamp((e.clientX-r.left)/r.width,0,1)-.5;
            const y=clamp((e.clientY-r.top)/r.height,0,1)-.5;
            el.style.transform+=` rotateX(${y*-3}deg) rotateY(${x*3}deg)`;
          });
        });
      },{passive:true});
      addEventListener('pointerleave',()=>{ cards.forEach(el=>{ el.style.transform='translate3d(0,0,0)'; }); },{passive:true});
    })();

    /* Mini-Tools (Runway/ICS) â€“ schlank */
    (function tools(){
      const nf = new Intl.NumberFormat('de-DE',{maximumFractionDigits:1});
      const runwayOut = $('#runwayOut'); // optional vorhanden
      const readNum = id => { const el = document.getElementById(id); if(!el) return NaN; const v = (el.value||'').toString().replace(',', '.'); return Number(v); };
      function calcRunway(){
        if(!runwayOut) return;
        const exp = readNum('exp'); const fund = readNum('fund');
        if(!(exp>0) || !(fund>0)){ runwayOut.textContent='Gib zwei Werte ein.'; return; }
        const months = fund/exp;
        const color = months<3?'ğŸ”´': months<6?'ğŸŸ¡':'ğŸŸ¢';
        runwayOut.innerHTML = `${color} Reichweite: <strong>${nf.format(months)}</strong> Monate Â· Empfehlung: <em>${months<3?'Jetzt':'Als NÃ¤chstes'}</em>`;
      }
      ['exp','fund'].forEach(id=> document.getElementById(id)?.addEventListener('input', calcRunway, {passive:true}));

      // Checklist-Download
      $('#dlChecklist')?.addEventListener('click', ()=>{
        const name = ($('#nameNF')?.value||'').trim();
        const lines = [
          'Notfall-Kontakte: _________',
          'Police/Nummern: _________',
          'Bank-ZugÃ¤nge (Ort): _________',
          'Vollmachten (Ort): _________',
        ];
        const txt = `Notfall-Checkliste${name? ' â€“ '+name : ''}\n\n`+lines.join('\n');
        const blob = new Blob([txt], {type:'text/plain;charset=utf-8'});
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download='notfall-checkliste.txt';
        document.body.append(a); a.click(); a.remove(); setTimeout(()=>URL.revokeObjectURL(a.href), 200);
      }, {passive:true});

      // ICS Reminder
      $('#icsBtn')?.addEventListener('click', ()=>{
        const title = ($('#todoTitle')?.value||'Ruhiger 20-Min Blick').replace(/\n/g,' ');
        const start = new Date(); start.setDate(start.getDate()+7); start.setHours(10,0,0,0);
        const end = new Date(start.getTime()+20*60000);
        const dt = d=> d.toISOString().replace(/[-:]/g,'').split('.')[0]+'Z';
        const ics = [
          'BEGIN:VCALENDAR','VERSION:2.0','PRODID:-//HH//Quiet//DE',
          'BEGIN:VEVENT','DTSTAMP:'+dt(new Date()),'DTSTART:'+dt(start),'DTEND:'+dt(end),
          'SUMMARY:'+title,'DESCRIPTION:2-Minuten-Blick â€“ als NÃ¤chstes in Ruhe weiter.','END:VEVENT','END:VCALENDAR'
        ].join('\r\n');
        const a=document.createElement('a'); a.href='data:text/calendar;charset=utf-8,'+encodeURIComponent(ics); a.download='als-naechstes.ics'; document.body.append(a); a.click(); a.remove();
      }, {passive:true});
    })();

    /* Ampel-Check */
    (function() {
      let step=1, score=0; const max=3;
      const startHero=$('#startCheckHero');
      const startBtn=$('#startCheckBtn');
      const stepsWrap=$('#check-steps');
      const resultBox=$('#check-result');
      const stepLabel=$('#stepLabel');
      const stepHint=$('#stepHint');
      const dialPct=$('#dialPct');
      const shareSection=$('#share');

      if(!stepsWrap || !resultBox) return;

      function setDial(p){ $('.progress-dial')?.style.setProperty('--p', p); dialPct.textContent = Math.round(p)+'%'; }
      function showStep(n){
        $$('.step').forEach(s=> s.classList.remove('active'));
        $(`.step[data-step="${n}"]`)?.classList.add('active');
        stepLabel.textContent = `Schritt ${n} von ${max}`;
        stepHint.textContent = 'Intuition reicht.';
        setDial((n-1)/max*100);
      }
      function vibrate(ms){ try{ navigator.vibrate && navigator.vibrate(ms); }catch(_){ } }
      function renderCTA(color){
        const base='https://wa.me/4917660408380?text=';
        const pdfBtn = `<button class="btn btn-ghost" id="exportPDF" type="button">ğŸ–¨ï¸ PDF-Export</button>`;
        if(color==='red') return `<div class="stack center"><a href="${base+encodeURIComponent('Kurz 10 Minuten sprechen')}" class="btn btn-primary" rel="noopener" target="_blank">ğŸ’¬ Kurz sprechen â€“ 10 Minuten</a>${pdfBtn}</div>`;
        if(color==='yellow') return `<div class="stack center"><a href="${base+encodeURIComponent('Als NÃ¤chstes angehen')}" class="btn btn-primary" rel="noopener" target="_blank">ğŸ§­ Als NÃ¤chstes angehen</a>${pdfBtn}</div>`;
        return `<div class="stack center"><a href="${base+encodeURIComponent('Smarter machen?')}" class="btn btn-primary" rel="noopener" target="_blank">âœ¨ Smarter machen?</a>${pdfBtn}</div>`;
      }
      function recommendations(color){
        if(color==='red') return `<ul class="micro"><li>Jetzt 1â€“2 Themen klÃ¤ren.</li><li>Mini-Plan schreiben (30â€“60â€‰Min).</li></ul>`;
        if(color==='yellow') return `<ul class="micro"><li>2 Dinge kurz fokussieren.</li><li>Dann entspannt laufen lassen.</li></ul>`;
        return `<ul class="micro"><li>Alles stabil.</li><li>In 6â€“12 Monaten wieder schauen.</li></ul>`;
      }
      function finish(){
        stepsWrap.style.display='none'; stepsWrap.setAttribute('aria-busy','false');
        resultBox.style.display='block';
        const color = score<=4 ? 'red' : score<=7 ? 'yellow' : 'green';
        const title = color==='red'?'ğŸ”´ Heute wichtig':color==='yellow'?'ğŸŸ¡ Bald wichtig':'ğŸŸ¢ Passt fÃ¼r heute';
        resultBox.innerHTML = `<div class="result-card" data-tilt>
          <h3>${title}</h3><p class="micro">Deine Empfehlungen:</p>${recommendations(color)}${renderCTA(color)}
        </div><p class="micro" style="margin-top:.8rem;opacity:.85">Wenn dir die Ampel nichts bringt â†’ <strong>25 â‚¬</strong>.</p>`;
        resultBox.scrollIntoView({behavior:'smooth',block:'start'});
        setDial(100); whoosh();
        $('#exportPDF')?.addEventListener('click', ()=> window.print(), {passive:true});
        if(shareSection) shareSection.style.display='';
        $('#share-title')?.focus?.();
      }
      function start(){
        $('#check-start').style.display='none';
        stepsWrap.style.display='block'; stepsWrap.setAttribute('aria-busy','true');
        resultBox.style.display='none'; setDial(0);
        step=1; score=0; showStep(step);
      }
      startHero?.addEventListener('click',e=>{ e.preventDefault(); start(); }, {passive:false});
      startBtn?.addEventListener('click', start, {passive:true});
      $('#ctaFinal')?.addEventListener('click',e=>{ e.preventDefault(); start(); }, {passive:false});
      $('#restartBtn')?.addEventListener('click', ()=>{ score=0; start(); }, {passive:true});

      // Keyboard 1/2/3
      addEventListener('keydown',(e)=>{
        if(stepsWrap.style.display==='none') return;
        if(e.key==='1'||e.key==='2'||e.key==='3'){
          const btn = $(`.step[data-step="${step}"] .btn[data-value="${e.key}"]`);
          if(btn){ e.preventDefault(); btn.click(); }
        }
      });

      // Button clicks
      $$('#check-steps .step').forEach(s=>{
        $$('.btn', s).forEach(btn=>{
          btn.addEventListener('click', ()=>{
            score += Number(btn.getAttribute('data-value'))||0;
            vibrate(12);
            step++; if(step>3) finish(); else showStep(step);
          }, {passive:true});
        });
      });
    })();

    /* Share composer */
    (function(){
      const area = $('#refText'), name = $('#refName');
      const wa = $('#waShare'), mail = $('#mailShare'), preview=$('#sharePreview');
      const buildURL = ()=> location.origin.replace(/\/$/,'') + location.pathname;
      const variants = () => ({
        neutral: [
          "2-Minuten-Blick, anonym â€“ zeigt nur Status. {{URL}}",
          "Ruhig & ohne Druck: schneller Status. {{URL}}"
        ],
        eltern: ["Kurz & ruhig: zeigt, ob heute etwas fehlt â€“ ohne Verkauf. {{URL}}"],
        kollegen: ["Fixer Blick fÃ¼r die To-do-Liste â€“ sofort sehen, ob was fehlt. {{URL}}"],
        freunde: ["Null Druck, nur Orientierung in 2 Minuten. {{URL}}"],
        selbst: ["Kurzer Status heute, ohne Papierkram. {{URL}}"],
        partner: ["Magst du 2 Minuten schauen? Ampel zeigt nur den Status. {{URL}}"]
      });
      function detectSeg(){
        const t=(area?.value||'').toLowerCase();
        if(/kind|schule|eltern/.test(t)) return 'eltern';
        if(/chef|team|kolleg/.test(t)) return 'kollegen';
        if(/freund/.test(t)) return 'freunde';
        if(/selbst|kunde|projekt/.test(t)) return 'selbst';
        if(/partner|partnerin/.test(t)) return 'partner';
        return 'neutral';
      }
      function pick(seg){ const sets=variants(); const pool=(sets[seg]||sets.neutral||[]); if(!pool.length) return ''; const i=Math.floor(Math.random()*pool.length); return pool[i]; }
      function ensureURL(text){ return /\bhttps?:\/\/\S+/i.test(text) ? text.trim() : (text.trim()+' '+buildURL()); }
      function setTextFrom(seg){ const tmpl=pick(seg||detectSeg()); if(!tmpl) return; area.value=tmpl.replace(/\{\{URL\}\}/g, buildURL()); updateLinks(); }
      const plain=()=> (area.value||'').replace(/\n+/g,' ').trim();
      function updateLinks(){
        const t=ensureURL(plain()); const enc=encodeURIComponent(t);
        wa && (wa.href='https://wa.me/?text='+enc);
        mail && (mail.href='mailto:?subject='+encodeURIComponent('Kurzer Blick')+'&body='+enc);
        preview && (preview.textContent = t.length<=190 ? t : (t.substring(0, t.lastIndexOf(' ',190))+'â€¦'));
      }
      if(area && !area.value){ setTextFrom('neutral'); } updateLinks();

      const toast=(msg)=>{ const t=document.createElement('div'); t.textContent=msg;
        Object.assign(t.style,{position:'fixed',right:'16px',bottom:'16px',background:'#111827',color:'#fff',padding:'.6rem .8rem',borderRadius:'10px',zIndex:90,boxShadow:'0 10px 28px rgba(0,0,0,.35)'}); document.body.append(t);
        setTimeout(()=>t.remove(),1600);
      };

      $('#readyMsg')?.addEventListener('click', ()=>{ setTextFrom(); toast('Fertiger Text eingefÃ¼gt âœ”ï¸'); }, {passive:true});
      $('#magicLine')?.addEventListener('click', ()=>{ const line='Hey, hab das gerade gesehen â€“ dachte sofort an dich.'; const cur=(area.value||'').trim(); area.value = cur ? line+'\n\n'+cur : line+'\n\n'+buildURL(); updateLinks(); }, {passive:true});
      $('#addPersonal')?.addEventListener('click', ()=>{ const alias=(name?.value||'').trim()||'Hey'; area.value = (area.value||'') + `\n\n${alias.split(' ')[0]}, dachte an dich, weil â€¦`; updateLinks(); }, {passive:true});
      $('#copyShare')?.addEventListener('click', async ()=>{ try{ await navigator.clipboard.writeText(ensureURL(area.value)); toast('Kopiert ğŸ“‹'); } catch(_){ area.select(); document.execCommand && document.execCommand('copy'); }}, {passive:true});
      $('#nativeShare')?.addEventListener('click', async ()=>{ const t=ensureURL(area.value); const url=buildURL(); if(navigator.share){ try{ await navigator.share({title:'2-Minuten-Blick', text:t, url}); }catch(_){}}}, {passive:true});
    })();

    /* Micro-copy shuffle */
    (function(){
      const el=$('#heroLine'); const pref=matchMedia('(prefers-reduced-motion: reduce)').matches; if(!el||pref) return;
      const lines=['Ruhig. Anonym. Ohne Verkauf.','Nur Orientierung. Kein Drama.','Jetzt Â· Als NÃ¤chstes Â· SpÃ¤ter.'];
      let i=0; setInterval(()=>{ i=(i+1)%lines.length; el.textContent=lines[i]; }, 6000);
    })();

    /* Sound toggle */
    (function(){
      const btn=$('#soundBtn'); if(!btn) return;
      btn.addEventListener('click', async ()=>{
        audioEnabled=!audioEnabled;
        btn.setAttribute('aria-pressed', audioEnabled?'true':'false');
        btn.textContent = audioEnabled ? 'ğŸ”Š Sound' : 'ğŸ”ˆ Sound';
        if(audioEnabled){ try{ audioCtx = audioCtx || new (window.AudioContext||window.webkitAudioContext)(); await audioCtx.resume(); whoosh(); }catch(_){ } }
      }, {passive:true});
    })();
  })();
  </script>
</body>
</html>
